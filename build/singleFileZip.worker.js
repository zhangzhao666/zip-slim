let e=null;const t=(t,r=0)=>{e||(()=>{const t=Int32Array,r=new t(256),s=new t(4096);let n,o,a;for(o=0;o<256;o++){n=o;for(let e=0;e<8;e++)n=1&n?-306674912^n>>>1:n>>>1;s[o]=r[o]=n}for(o=0;o<256;o++)for(a=r[o],n=256+o;n<4096;n+=256)a=s[n]=a>>>8^r[255&a];for(e=[r],o=1;o<16;o++)e[o]=s.subarray(256*o,256*(o+1))})();const[s,n,o,a,c,l,d,i,f,m,g,h,u,p,w,y]=e;let S=~r,b=0;const z=t.length-15;for(;b<z;)S=y[t[b++]^255&S]^w[t[b++]^S>>8&255]^p[t[b++]^S>>16&255]^u[t[b++]^S>>>24]^h[t[b++]]^g[t[b++]]^m[t[b++]]^f[t[b++]]^i[t[b++]]^d[t[b++]]^l[t[b++]]^c[t[b++]]^a[t[b++]]^o[t[b++]]^n[t[b++]]^s[t[b++]];for(;b<t.length;)S=S>>>8^s[255&(S^t[b++])];return~S>>>0},r=new TextEncoder,s=(new TextDecoder("utf-8"),"undefined"!=typeof CompressionStream);self.onmessage=async e=>{const{fileData:n,fileName:o,compressWhenPossible:a}=e.data;try{const e=await async function(e,n,o,a=new Date){const c=e,l=r.encode(n),d=c.length,i=t(c),{mtime:f,mdate:m}={mtime:((g=a).getSeconds()/2|0)+(g.getMinutes()<<5)+(g.getHours()<<11),mdate:g.getDate()+(g.getMonth()+1<<5)+(g.getFullYear()-1980<<9)};var g;let h=d,u=0,p=c;if(o&&s)try{const e=new CompressionStream("gzip"),t=e.writable.getWriter(),r=e.readable.getReader();t.write(c),t.close();const s=[];let n=0;for(;;){const{value:e,done:t}=await r.read();if(t)break;e&&(s.push(e),n+=e.length)}const o=new Uint8Array(n);let a=0;for(const e of s)o.set(e,a),a+=e.length;const l=o.subarray(10,n-8);l.length<d&&(h=l.length,p=l,u=8)}catch(e){}const w=30+l.length,y=new Uint8Array(w);let S=0;return y[S++]=80,y[S++]=75,y[S++]=3,y[S++]=4,y[S++]=20,y[S++]=0,y[S++]=0,y[S++]=0,y[S++]=u,y[S++]=0,y[S++]=255&f,y[S++]=f>>8,y[S++]=255&m,y[S++]=m>>8,y[S++]=255&i,y[S++]=i>>8&255,y[S++]=i>>16&255,y[S++]=i>>24,y[S++]=255&h,y[S++]=h>>8&255,y[S++]=h>>16&255,y[S++]=h>>24,y[S++]=255&d,y[S++]=d>>8&255,y[S++]=d>>16&255,y[S++]=d>>24,y[S++]=255&l.length,y[S++]=l.length>>8,y[S++]=0,y[S++]=0,y.set(l,30),{localHeader:y,compressedData:p,uncompressedSize:d,compressedSize:h,crc:i,method:u}}(new Uint8Array(n),o,a),c=new Uint8Array(e.localHeader.length+e.compressedData.length);c.set(e.localHeader),c.set(e.compressedData,e.localHeader.length),self.postMessage({result:c.buffer,fileName:o,uncompressedSize:e.uncompressedSize,compressedSize:e.compressedSize,crc:e.crc,method:e.method},{transfer:[c.buffer]})}catch(e){self.postMessage({error:e})}};